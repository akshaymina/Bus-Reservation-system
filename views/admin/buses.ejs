<%
    const content = `
    <div class="row mb-4">
        <div class="col">
            <h2>Manage Buses</h2>
        </div>
        <div class="col text-end">
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addBusModal">
                <i class="fas fa-plus"></i> Add New Bus
            </button>
        </div>
    </div>

    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Bus Number</th>
                    <th>Bus Name</th>
                    <th>Source</th>
                    <th>Destination</th>
                    <th>Departure Time</th>
                    <th>Arrival Time</th>
                    <th>Total Seats</th>
                    <th>Fare</th>
                    <th>Bus Type</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                ${buses && buses.length > 0 ? buses.map(bus => `
                    <tr>
                        <td>${bus.busNumber}</td>
                        <td>${bus.busName}</td>
                        <td>${bus.source}</td>
                        <td>${bus.destination}</td>
                        <td>${new Date(bus.departureTime).toLocaleString()}</td>
                        <td>${new Date(bus.arrivalTime).toLocaleString()}</td>
                        <td>${bus.totalSeats}</td>
                        <td>â‚¹${bus.fare}</td>
                        <td>${bus.busType}</td>
                        <td>
                            <button class="btn btn-sm btn-info" onclick="editBus('${bus.id}')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deleteBus('${bus.id}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('') : `
                    <tr>
                        <td colspan="10" class="text-center">No buses found</td>
                    </tr>
                `}
            </tbody>
        </table>
    </div>

    <!-- Add Bus Modal -->
    <div class="modal fade" id="addBusModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Bus</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form action="/admin/buses" method="POST">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">Bus Number</label>
                            <input type="text" class="form-control" name="busNumber" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Bus Name</label>
                            <input type="text" class="form-control" name="busName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Source</label>
                            <input type="text" class="form-control" name="source" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Destination</label>
                            <input type="text" class="form-control" name="destination" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Departure Time</label>
                            <input type="datetime-local" class="form-control" name="departureTime" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Arrival Time</label>
                            <input type="datetime-local" class="form-control" name="arrivalTime" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Total Seats</label>
                            <input type="number" class="form-control" name="totalSeats" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Fare</label>
                            <input type="number" class="form-control" name="fare" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Bus Type</label>
                            <select class="form-control" name="busType" required>
                                <option value="AC">AC</option>
                                <option value="Non-AC">Non-AC</option>
                                <option value="Sleeper">Sleeper</option>
                                <option value="Semi-Sleeper">Semi-Sleeper</option>
                            </select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Add Bus</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    `;
%>
<%- include('../layouts/admin-layout', { content }) %>

<script>
function editBus(busId) {
    // TODO: Implement edit bus functionality
    alert('Edit bus: ' + busId);
}

function deleteBus(busId) {
    if (confirm('Are you sure you want to delete this bus?')) {
        // TODO: Implement delete bus functionality
        alert('Delete bus: ' + busId);
    }
}
</script> 